<!DOCTYPE HTML>
<html lang="zh-CN">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="Day3-pandas-Ⅱ, 小窝窝 (伸懒腰)">
    <meta name="description" content="描述是...">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <!-- Global site tag (gtag.js) - Google Analytics -->

<script async src="https://www.googletagmanager.com/gtag/js?id="></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag() {
        dataLayer.push(arguments);
    }

    gtag('js', new Date());
    gtag('config', '');
</script>


    <title>Day3-pandas-Ⅱ | 小窝窝 (伸懒腰)</title>
    <link rel="icon" type="image/png" href="/favicon.png">

    <link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.css">
    <link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
    <link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
    <link rel="stylesheet" type="text/css" href="/css/matery.css">
    <link rel="stylesheet" type="text/css" href="/css/my.css">

    <script src="/libs/jquery/jquery.min.js"></script>

<meta name="generator" content="Hexo 5.4.0">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
</head>




<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">小窝窝 (伸懒腰)</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>首页</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/tags" class="waves-effect waves-light">
      
      <i class="fas fa-tags" style="zoom: 0.6;"></i>
      
      <span>标签</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>分类</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>归档</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>关于</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/contact" class="waves-effect waves-light">
      
      <i class="fas fa-comments" style="zoom: 0.6;"></i>
      
      <span>留言板</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="搜索" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">小窝窝 (伸懒腰)</div>
        <div class="logo-desc">
            
            描述是...
            
        </div>
    </div>

    

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			首页
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/tags" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-tags"></i>
			
			标签
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			分类
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			归档
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			关于
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/contact" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-comments"></i>
			
			留言板
		</a>
          
        </li>
        
        
        <li><div class="divider"></div></li>
        <li>
            <a href="https://github.com/cyawu" class="waves-effect waves-light" target="_blank">
                <i class="fab fa-github-square fa-fw"></i>Fork Me
            </a>
        </li>
        
    </ul>
</div>


        </div>

        
            <style>
    .nav-transparent .github-corner {
        display: none !important;
    }

    .github-corner {
        position: absolute;
        z-index: 10;
        top: 0;
        right: 0;
        border: 0;
        transform: scale(1.1);
    }

    .github-corner svg {
        color: #0f9d58;
        fill: #fff;
        height: 64px;
        width: 64px;
    }

    .github-corner:hover .octo-arm {
        animation: a 0.56s ease-in-out;
    }

    .github-corner .octo-arm {
        animation: none;
    }

    @keyframes a {
        0%,
        to {
            transform: rotate(0);
        }
        20%,
        60% {
            transform: rotate(-25deg);
        }
        40%,
        80% {
            transform: rotate(10deg);
        }
    }
</style>

<a href="https://github.com/cyawu" class="github-corner tooltipped hide-on-med-and-down" target="_blank"
   data-tooltip="Fork Me" data-position="left" data-delay="50">
    <svg viewBox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
              fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
              fill="currentColor" class="octo-body"></path>
    </svg>
</a>
        
    </nav>

</header>

    



<div class="bg-cover pd-header post-cover" style="background-image: url('/medias/featureimages/21.jpg')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">Day3-pandas-Ⅱ</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
<style>
    #articleContent h1::before,
    #articleContent h2::before,
    #articleContent h3::before,
    #articleContent h4::before,
    #articleContent h5::before,
    #articleContent h6::before {
        display: block;
        content: " ";
        height: 100px;
        margin-top: -100px;
        visibility: hidden;
    }

    #articleContent :focus {
        outline: none;
    }

    .toc-fixed {
        position: fixed;
        top: 64px;
    }

    .toc-widget {
        width: 345px;
        padding-left: 20px;
    }

    .toc-widget .toc-title {
        padding: 35px 0 15px 17px;
        font-size: 1.5rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    .toc-widget ol {
        padding: 0;
        list-style: none;
    }

    #toc-content {
        padding-bottom: 30px;
        overflow: auto;
    }

    #toc-content ol {
        padding-left: 10px;
    }

    #toc-content ol li {
        padding-left: 10px;
    }

    #toc-content .toc-link:hover {
        color: #42b983;
        font-weight: 700;
        text-decoration: underline;
    }

    #toc-content .toc-link::before {
        background-color: transparent;
        max-height: 25px;

        position: absolute;
        right: 23.5vw;
        display: block;
    }

    #toc-content .is-active-link {
        color: #42b983;
    }

    #floating-toc-btn {
        position: fixed;
        right: 15px;
        bottom: 76px;
        padding-top: 15px;
        margin-bottom: 0;
        z-index: 998;
    }

    #floating-toc-btn .btn-floating {
        width: 48px;
        height: 48px;
    }

    #floating-toc-btn .btn-floating i {
        line-height: 48px;
        font-size: 1.4rem;
    }
</style>
<div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/Pandas/">
                                <span class="chip bg-color">Pandas</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                    <div class="post-cate">
                        <i class="fas fa-bookmark fa-fw icon-category"></i>
                        
                            <a href="/categories/%E6%95%B0%E6%8D%AE%E7%A7%91%E5%AD%A6/" class="post-category">
                                数据科学
                            </a>
                        
                    </div>
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>发布日期:&nbsp;&nbsp;
                    2021-03-04
                </div>
                

                

                

                

                
            </div>
        </div>
        <hr class="clearfix">

        
        <!-- 是否加载使用自带的 prismjs. -->
        <link rel="stylesheet" href="/libs/prism/prism.css">
        

        

        <div class="card-content article-card-content">
            <div id="articleContent">
                <h1 id="Day3-pandas-Ⅱ"><a href="#Day3-pandas-Ⅱ" class="headerlink" title="Day3-pandas-Ⅱ"></a>Day3-pandas-Ⅱ</h1><h2 id="拓展：傅里叶"><a href="#拓展：傅里叶" class="headerlink" title="拓展：傅里叶"></a>拓展：傅里叶</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token comment">#fft 傅里叶转换，ifft傅里叶反转</span>
<span class="token keyword">from</span> numpy<span class="token punctuation">.</span>fft <span class="token keyword">import</span> fft<span class="token punctuation">,</span>ifft
<span class="token keyword">from</span> PIL <span class="token keyword">import</span> Image
<span class="token comment">#第一步读取数据</span>
img_data <span class="token operator">=</span> Image<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'cat.png'</span><span class="token punctuation">)</span>
<span class="token comment">#转换成int类型数据，int8 == 128</span>
result <span class="token operator">=</span> np<span class="token punctuation">.</span>fromstring<span class="token punctuation">(</span>img_data<span class="token punctuation">.</span>tobytes<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>dtype<span class="token operator">=</span>np<span class="token punctuation">.</span>int8<span class="token punctuation">)</span>
<span class="token comment">#傅里叶转换,傅里叶转换的结果包含实数，和虚数</span>
fft_result <span class="token operator">=</span> fft<span class="token punctuation">(</span>result<span class="token punctuation">)</span>
<span class="token comment">#将傅里叶的数据去除低频的波,设置为0</span>
fft_result <span class="token operator">=</span> np<span class="token punctuation">.</span>where<span class="token punctuation">(</span>np<span class="token punctuation">.</span><span class="token builtin">abs</span><span class="token punctuation">(</span>fft_result<span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token number">1e5</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>fft_result<span class="token punctuation">)</span>
<span class="token comment">#使用傅里叶进行反转</span>
ifft_result <span class="token operator">=</span> ifft<span class="token punctuation">(</span>fft_result<span class="token punctuation">)</span>
<span class="token comment">#获取实数</span>
result <span class="token operator">=</span> np<span class="token punctuation">.</span>real<span class="token punctuation">(</span>ifft_result<span class="token punctuation">)</span>
<span class="token comment">#去除小数部分</span>
result <span class="token operator">=</span> np<span class="token punctuation">.</span>int8<span class="token punctuation">(</span>result<span class="token punctuation">)</span>
<span class="token comment">#将一维的数组，通过Image进行转换,图片</span>
im_result <span class="token operator">=</span> Image<span class="token punctuation">.</span>frombytes<span class="token punctuation">(</span>img_data<span class="token punctuation">.</span>mode<span class="token punctuation">,</span>img_data<span class="token punctuation">.</span>size<span class="token punctuation">,</span>result<span class="token punctuation">)</span>
<span class="token comment">#显示图片</span>
im_result<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="pandas层次化索引"><a href="#pandas层次化索引" class="headerlink" title="pandas层次化索引"></a>pandas层次化索引</h2><h3 id="创建多层索引"><a href="#创建多层索引" class="headerlink" title="创建多层索引"></a>创建多层索引</h3><ul>
<li><p>隐式构造</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">df <span class="token operator">=</span> DataFrame<span class="token punctuation">(</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>rand<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
               index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span><span class="token string">'a'</span><span class="token punctuation">,</span><span class="token string">'b'</span><span class="token punctuation">,</span><span class="token string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
              columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'data1'</span><span class="token punctuation">,</span><span class="token string">'data2'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
df<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>输出：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">		  data1		  data2
a	<span class="token number">1</span>	<span class="token number">0.495897</span>	<span class="token number">0.130101</span>
	<span class="token number">2</span>	<span class="token number">0.551563</span>	<span class="token number">0.450209</span>
b	<span class="token number">1</span>	<span class="token number">0.664648</span>	<span class="token number">0.701401</span>
	<span class="token number">2</span>	<span class="token number">0.442188</span>	<span class="token number">0.500506</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li>Series也可以创建多层索引</li>
</ul>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">s <span class="token operator">=</span> Series<span class="token punctuation">(</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>rand<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span>index <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span><span class="token string">'a'</span><span class="token punctuation">,</span><span class="token string">'b'</span><span class="token punctuation">,</span><span class="token string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>  <code>s</code></p>
  <pre class="line-numbers language-python" data-language="python"><code class="language-python">输出：
a  <span class="token number">1</span>    <span class="token number">0.192162</span>
    <span class="token number">2</span>    <span class="token number">0.236828</span>
b  <span class="token number">1</span>    <span class="token number">0.560971</span>
    <span class="token number">2</span>    <span class="token number">0.751398</span>
dtype<span class="token punctuation">:</span> float64<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
  <pre class="line-numbers language-none"><code class="language-none">    <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li>
<li><p>显示构造MultiIndex</p>
<ul>
<li><p>创建MultiIndex</p>
<ul>
<li>使用数组  <pre class="line-numbers language-python" data-language="python"><code class="language-python">Mindex <span class="token operator">=</span> pd<span class="token punctuation">.</span>MultiIndex<span class="token punctuation">.</span>from_arrays<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span><span class="token string">'a'</span><span class="token punctuation">,</span><span class="token string">'b'</span><span class="token punctuation">,</span><span class="token string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
Mindex
输出：
MultiIndex<span class="token punctuation">(</span>levels<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
           labels<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
<li>使用tuple  <pre class="line-numbers language-python" data-language="python"><code class="language-python">Mindex <span class="token operator">=</span> pd<span class="token punctuation">.</span>MultiIndex<span class="token punctuation">.</span>from_tuples<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token string">'b'</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token string">'b'</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
Mindex
输出：
MultiIndex<span class="token punctuation">(</span>levels<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
           labels<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
<li>使用product  <pre class="line-numbers language-python" data-language="python"><code class="language-python">Mindex <span class="token operator">=</span> pd<span class="token punctuation">.</span>MultiIndex<span class="token punctuation">.</span>from_product<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span><span class="token string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
Mindex
输出：
MultiIndex<span class="token punctuation">(</span>levels<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
           labels<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ul>
</li>
<li><p>人口统计</p>
  <pre class="line-numbers language-python" data-language="python"><code class="language-python">index <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token string">'California'</span><span class="token punctuation">,</span><span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token string">'California'</span><span class="token punctuation">,</span><span class="token number">2010</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token string">'New York'</span><span class="token punctuation">,</span><span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token string">'New York'</span><span class="token punctuation">,</span><span class="token number">2010</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token string">'Texas'</span><span class="token punctuation">,</span><span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token string">'Texas'</span><span class="token punctuation">,</span><span class="token number">2010</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
Mindex <span class="token operator">=</span> pd<span class="token punctuation">.</span>MultiIndex<span class="token punctuation">.</span>from_tuples<span class="token punctuation">(</span>index<span class="token punctuation">)</span>
Mindex <span class="token operator">=</span> pd<span class="token punctuation">.</span>MultiIndex<span class="token punctuation">.</span>from_product<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'California'</span><span class="token punctuation">,</span><span class="token string">'New York'</span><span class="token punctuation">,</span><span class="token string">'Texas'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">2000</span><span class="token punctuation">,</span><span class="token number">2010</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
pop <span class="token operator">=</span> DataFrame<span class="token punctuation">(</span>populations<span class="token punctuation">,</span>index<span class="token operator">=</span>Mindex<span class="token punctuation">,</span>columns <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'人口'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
pop<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">输出：
							人口
California	<span class="token number">2000</span>	<span class="token number">33871648</span>
				<span class="token number">2010</span>	<span class="token number">37253956</span>
New York	<span class="token number">2000</span>	<span class="token number">18976457</span>
				<span class="token number">2010</span>	<span class="token number">19378102</span>
Texas	<span class="token number">2000</span>	<span class="token number">20851820</span>
			<span class="token number">2010</span>	<span class="token number">25145561</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ul>
</li>
<li><p>练习：<br>创建一个DataFrame，表示出张三李四期中期末各科成绩</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">a <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">150</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
Mindex <span class="token operator">=</span> pd<span class="token punctuation">.</span>MultiIndex<span class="token punctuation">.</span>from_product<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'语文'</span><span class="token punctuation">,</span><span class="token string">'数学'</span><span class="token punctuation">,</span><span class="token string">'英语'</span><span class="token punctuation">,</span><span class="token string">'理综'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token string">'期中'</span><span class="token punctuation">,</span><span class="token string">'期末'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
ddd <span class="token operator">=</span> DataFrame<span class="token punctuation">(</span>data <span class="token operator">=</span> a<span class="token punctuation">,</span>
                index <span class="token operator">=</span> Mindex<span class="token punctuation">,</span>
                columns <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'张三'</span><span class="token punctuation">,</span><span class="token string">'李四'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
ddd<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-none"><code class="language-none">输出：
				张三	李四
语文	期中	90		55
		期末	59		20
数学	期中	132	85
		期末	65		116
英语	期中	57		28
		期末	73		145
理综	期中	142	48
		期末	120	54<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="多层列索引"><a href="#多层列索引" class="headerlink" title="多层列索引"></a>多层列索引</h3></li>
<li><p>除了行索引index，列索引columns也能用同样的方法创建多层索引</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">a <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">150</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

Mindex <span class="token operator">=</span> pd<span class="token punctuation">.</span>MultiIndex<span class="token punctuation">.</span>from_product<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'语文'</span><span class="token punctuation">,</span><span class="token string">'数学'</span><span class="token punctuation">,</span><span class="token string">'英语'</span><span class="token punctuation">,</span><span class="token string">'理综'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token string">'期中'</span><span class="token punctuation">,</span><span class="token string">'期末'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

ddd <span class="token operator">=</span> DataFrame<span class="token punctuation">(</span>data <span class="token operator">=</span> a<span class="token punctuation">,</span>

                index <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'张三'</span><span class="token punctuation">,</span><span class="token string">'李四'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  
                columns <span class="token operator">=</span> Mindex<span class="token punctuation">)</span>

ddd<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ul>
<pre class="line-numbers language-none"><code class="language-none">输出：

语文	数学	英语	理综

期中	期末	期中	期末	期中	期末	期中	期末

张三	57	110	65	3	127	66	146	32

李四	73	24	57	19	35	133	57	127<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="多层索引对象的索引与切片操作"><a href="#多层索引对象的索引与切片操作" class="headerlink" title="多层索引对象的索引与切片操作"></a>多层索引对象的索引与切片操作</h3><ul>
<li><p>Series的操作</p>
<ul>
<li>【重要】对于Series来说，直接中括号[]与使用.loc()完全一样，因此，推荐使用中括号索引和切片<pre class="line-numbers language-python" data-language="python"><code class="language-python">index <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token string">'California'</span><span class="token punctuation">,</span><span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token string">'California'</span><span class="token punctuation">,</span><span class="token number">2010</span><span class="token punctuation">)</span><span class="token punctuation">,</span>

        <span class="token punctuation">(</span><span class="token string">'New York'</span><span class="token punctuation">,</span><span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token string">'New York'</span><span class="token punctuation">,</span><span class="token number">2010</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
 
        <span class="token punctuation">(</span><span class="token string">'Texas'</span><span class="token punctuation">,</span><span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token string">'Texas'</span><span class="token punctuation">,</span><span class="token number">2010</span><span class="token punctuation">)</span><span class="token punctuation">]</span>

index <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'California'</span><span class="token punctuation">,</span><span class="token string">'California'</span><span class="token punctuation">,</span><span class="token string">'New York'</span><span class="token punctuation">,</span><span class="token string">'New York'</span><span class="token punctuation">,</span><span class="token string">'Texas'</span><span class="token punctuation">,</span><span class="token string">'Texas'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">2000</span><span class="token punctuation">,</span><span class="token number">2010</span><span class="token punctuation">,</span><span class="token number">2000</span><span class="token punctuation">,</span><span class="token number">2010</span><span class="token punctuation">,</span><span class="token number">2000</span><span class="token punctuation">,</span><span class="token number">2010</span><span class="token punctuation">]</span><span class="token punctuation">]</span>

<span class="token comment"># index = pd.MultiIndex.from_product([['California','New York','Texas'],[2000,2010]]) #相同的效果</span>

populations <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">33871648</span><span class="token punctuation">,</span><span class="token number">37253956</span><span class="token punctuation">,</span>

              <span class="token number">18976457</span><span class="token punctuation">,</span><span class="token number">19378102</span><span class="token punctuation">,</span>
 
              <span class="token number">20851820</span><span class="token punctuation">,</span><span class="token number">25145561</span><span class="token punctuation">]</span>

pop <span class="token operator">=</span> Series<span class="token punctuation">(</span>populations<span class="token punctuation">,</span>index <span class="token operator">=</span> index<span class="token punctuation">)</span>

pop<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ul>
</li>
</ul>
<pre><code>  输出：
</code></pre>
<pre class="line-numbers language-none"><code class="language-none">California  2000    33871648

            2010    37253956

New York    2000    18976457

            2010    19378102

Texas       2000    20851820

            2010    25145561

dtype: int64<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre><code>    - 索引
</code></pre>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">pop<span class="token punctuation">[</span><span class="token string">'California'</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>


<pre><code>      输出：
</code></pre>
<pre class="line-numbers language-none"><code class="language-none">2000    33871648

2010    37253956

dtype: int64<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre><code>    - 切片
</code></pre>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">pop<span class="token punctuation">[</span><span class="token string">'California'</span><span class="token punctuation">:</span><span class="token string">'New York'</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>


<pre><code>      输出：
</code></pre>
<pre class="line-numbers language-none"><code class="language-none">California  2000    33871648

            2010    37253956

New York    2000    18976457

            2010    19378102

dtype: int64<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>


<p>​          </p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">pop<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>


<pre><code>      输出：
</code></pre>
<pre class="line-numbers language-none"><code class="language-none">Texas       2010    25145561

            2000    20851820

New York    2010    19378102

            2000    18976457

California  2010    37253956

            2000    33871648

dtype: int64<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>


<p>​          </p>
<pre class="line-numbers language-none"><code class="language-none">pop[:,2010]<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>


<pre><code>      输出：
</code></pre>
<pre class="line-numbers language-none"><code class="language-none">California    37253956

New York      19378102

Texas         25145561

dtype: int64<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ul>
<li><p>DataFrame的操作</p>
<ul>
<li>可以直接使用列名称来进行列索引<pre class="line-numbers language-python" data-language="python"><code class="language-python">index <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token string">'California'</span><span class="token punctuation">,</span><span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token string">'California'</span><span class="token punctuation">,</span><span class="token number">2010</span><span class="token punctuation">)</span><span class="token punctuation">,</span>

        <span class="token punctuation">(</span><span class="token string">'New York'</span><span class="token punctuation">,</span><span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token string">'New York'</span><span class="token punctuation">,</span><span class="token number">2010</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
 
        <span class="token punctuation">(</span><span class="token string">'Texas'</span><span class="token punctuation">,</span><span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token string">'Texas'</span><span class="token punctuation">,</span><span class="token number">2010</span><span class="token punctuation">)</span><span class="token punctuation">]</span>

populations <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">33871648</span><span class="token punctuation">,</span><span class="token number">37253956</span><span class="token punctuation">,</span>

              <span class="token number">18976457</span><span class="token punctuation">,</span><span class="token number">19378102</span><span class="token punctuation">,</span>
 
              <span class="token number">20851820</span><span class="token punctuation">,</span><span class="token number">25145561</span><span class="token punctuation">]</span>

Mindex <span class="token operator">=</span> pd<span class="token punctuation">.</span>MultiIndex<span class="token punctuation">.</span>from_product<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'California'</span><span class="token punctuation">,</span><span class="token string">'New York'</span><span class="token punctuation">,</span><span class="token string">'Texas'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">2000</span><span class="token punctuation">,</span><span class="token number">2010</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

pop <span class="token operator">=</span> DataFrame<span class="token punctuation">(</span>populations<span class="token punctuation">,</span>index<span class="token operator">=</span>Mindex<span class="token punctuation">,</span>columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'population'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

pop<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ul>
</li>
</ul>
<pre><code>  输出：
</code></pre>
<pre class="line-numbers language-none"><code class="language-none">population

California	2000	33871648

2010	37253956

New York	2000	18976457

2010	19378102

Texas	2000	20851820

2010	25145561<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-python" data-language="python"><code class="language-python">pop<span class="token punctuation">[</span><span class="token string">'population'</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>


<pre><code>  输出：
</code></pre>
<pre class="line-numbers language-none"><code class="language-none">California  2000    33871648

            2010    37253956

New York    2000    18976457

            2010    19378102

Texas       2000    20851820

            2010    25145561

Name: population, dtype: int64<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre><code>- 使用行索引需要用ix()，loc()等函数
</code></pre>
<p>【极其重要】推荐使用loc()函数</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">pop<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token string">'California'</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>


<pre><code>  输出：
</code></pre>
<pre class="line-numbers language-none"><code class="language-none">population

2000	33871648

2010	37253956<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-python" data-language="python"><code class="language-python">pop<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token string">'California'</span><span class="token punctuation">,</span><span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>


<pre><code>  输出：
</code></pre>
<pre class="line-numbers language-none"><code class="language-none">population    33871648

Name: (California, 2000), dtype: int64<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-python" data-language="python"><code class="language-python">pop<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token string">'California'</span><span class="token punctuation">,</span><span class="token number">2000</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>


<pre><code>  输出：
</code></pre>
<pre class="line-numbers language-none"><code class="language-none">population    33871648

Name: (California, 2000), dtype: int64<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-python" data-language="python"><code class="language-python">pop<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token string">'California'</span><span class="token punctuation">,</span><span class="token number">2000</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>


<pre><code>  输出：
</code></pre>
<pre class="line-numbers language-none"><code class="language-none">33871648<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<pre class="line-numbers language-python" data-language="python"><code class="language-python">pop<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token string">'California'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token number">2000</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>


<pre><code>  输出：
</code></pre>
<pre class="line-numbers language-none"><code class="language-none">population    33871648

Name: 2000, dtype: int64<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-python" data-language="python"><code class="language-python">pop<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token string">'California'</span><span class="token punctuation">,</span><span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'population'</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>


<pre><code>  输出：
</code></pre>
<pre class="line-numbers language-none"><code class="language-none">33871648<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<pre><code>- 注意在对行索引的时候，若一级行索引还有多个，对二级行索引会遇到问题！也就是说，无法直接对二级索引进行索引，必须让二级索引变成一级索引后才能对其进行索引！
</code></pre>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">pop<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token string">'California'</span><span class="token punctuation">:</span><span class="token string">'New York'</span><span class="token punctuation">,</span><span class="token number">2000</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>


<pre><code>  输出：
</code></pre>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">TypeError<span class="token punctuation">:</span> cannot do label indexing on <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token string">'pandas.core.indexes.base.Index'</span><span class="token operator">&gt;</span> <span class="token keyword">with</span> these indexers <span class="token punctuation">[</span><span class="token number">2000</span><span class="token punctuation">]</span> of <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token string">'int'</span><span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<ul>
<li>练习9：<br>分析比较Series和DataFrame各种索引的方式，熟练掌握.loc()方法<br>假设张三再一次在期中考试的时候因为特殊原因放弃英语考试，如何实现？</li>
</ul>
<h3 id="索引的堆（unstack）"><a href="#索引的堆（unstack）" class="headerlink" title="索引的堆（unstack）"></a>索引的堆（unstack）</h3><ul>
<li><p>unstack()</p>
<ul>
<li>【小技巧】使用unstack()的时候，level等于哪一个，哪一个就消失，出现在列里<pre class="line-numbers language-python" data-language="python"><code class="language-python">populations <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">33871648</span><span class="token punctuation">,</span><span class="token number">37253956</span><span class="token punctuation">,</span>

              <span class="token number">18976457</span><span class="token punctuation">,</span><span class="token number">19378102</span><span class="token punctuation">,</span>
 
              <span class="token number">20851820</span><span class="token punctuation">,</span><span class="token number">25145561</span><span class="token punctuation">]</span>

Mindex <span class="token operator">=</span> pd<span class="token punctuation">.</span>MultiIndex<span class="token punctuation">.</span>from_product<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'California'</span><span class="token punctuation">,</span><span class="token string">'New York'</span><span class="token punctuation">,</span><span class="token string">'Texas'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">2000</span><span class="token punctuation">,</span><span class="token number">2010</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

pop <span class="token operator">=</span> DataFrame<span class="token punctuation">(</span>populations<span class="token punctuation">,</span>index<span class="token operator">=</span>Mindex<span class="token punctuation">,</span>columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'population'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

pop<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ul>
</li>
</ul>
<pre><code>  输出：
</code></pre>
<pre class="line-numbers language-none"><code class="language-none">							population

California	2000		33871648

				2010		37253956

New York	2000		18976457

				2010		19378102

Texas		2000		20851820

				2010		25145561<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>


<pre><code>  ///////////////////////////////////////////////////////////////////////////////
<pre class="line-numbers language-python" data-language="python"><code class="language-python">pop<span class="token punctuation">.</span>unstack<span class="token punctuation">(</span>level<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</code></pre>
<p>​      </p>
<pre><code>  输出：
</code></pre>
<pre class="line-numbers language-none"><code class="language-none">		population
	
		California		New York		Texas
	
2000	33871648		18976457		20851820
	
2010	37253956		19378102		25145561<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>​```python<br>      pop.unstack(level=1)</p>
<pre class="line-numbers language-none"><code class="language-none">

输出：<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<pre><code>                      population

                          2000                2010

  California        33871648        37253956

  New York        18976457        19378102

  Texas            20851820        25145561
</code></pre>
<pre class="line-numbers language-none"><code class="language-none">- 练习10：
使用unstack()将ddd变为两行，分别为期中期末
使用unstack()将ddd变为四行，分别为四个科目

### 聚合操作

- 【注意】
需要指定level
【小技巧】和unstack()相反，聚合的时候，level等于哪一个，哪一个就保留
```python
  populations = [33871648,37253956,

                18976457,19378102,
    
                20851820,25145561]

  Mindex = pd.MultiIndex.from_product([['California','New York','Texas'],[2000,2010]])

  pop = DataFrame(populations,index=Mindex,columns=['population'])

  pop<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>


<p>  输出：</p>
<pre class="line-numbers language-none"><code class="language-none">							population

California	2000			33871648

				2010			37253956

New York	2000			18976457

				2010			19378102

Texas		2000			20851820

				2010			25145561<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<pre class="line-numbers language-python" data-language="python"><code class="language-python">pop<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>level<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>


<p>  输出：</p>
<pre class="line-numbers language-none"><code class="language-none">					population

California		35562802.0

New York		19177279.5

Texas			22998690.5<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-python" data-language="python"><code class="language-python">pop<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>level<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>


<p>  输出：</p>
<pre class="line-numbers language-none"><code class="language-none">				population

2000			2.456664e+07

2010			2.725921e+07<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>




<ul>
<li>练习11：<br>计算各个科目期中期末平均成绩<br>计算各科目张三李四的最高分<pre class="line-numbers language-python" data-language="python"><code class="language-python">df <span class="token operator">=</span> DataFrame<span class="token punctuation">(</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">150</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>

               index <span class="token operator">=</span> pd<span class="token punctuation">.</span>MultiIndex<span class="token punctuation">.</span>from_product<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'张三'</span><span class="token punctuation">,</span><span class="token string">'李四'</span><span class="token punctuation">,</span><span class="token string">'王五'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token string">'期中'</span><span class="token punctuation">,</span><span class="token string">'期末'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  
              columns <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'语文'</span><span class="token punctuation">,</span><span class="token string">'数学'</span><span class="token punctuation">,</span><span class="token string">'编程'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

display<span class="token punctuation">(</span>df<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"计算各个科目期中期末平均成绩"</span><span class="token punctuation">)</span>

display<span class="token punctuation">(</span>df<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>level <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"计算各科目张三李四的最高分"</span><span class="token punctuation">)</span>

display<span class="token punctuation">(</span>df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token string">'张三'</span><span class="token punctuation">:</span><span class="token string">'李四'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span>level <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ul>
<p>  输出：</p>
<pre class="line-numbers language-none"><code class="language-none">					语文	数学	编程

张三	期中		5		0		136

		期末		139	4		92

李四	期中		26		74		52

		期末		51		105	18

王五	期中		117	34		51

		期末		58		55		18<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>


<p>  计算各个科目期中期末平均成绩</p>
<pre class="line-numbers language-none"><code class="language-none">			语文				数学			    编程

期中	49.333333		36.000000		79.666667

期末	82.666667		54.666667		42.666667<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>


<p>  计算各科目张三李四的最高分</p>
<pre class="line-numbers language-none"><code class="language-none">			语文		数学		编程

期中		26			74			136

期末		139		105		92<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="pandas拼接操作"><a href="#pandas拼接操作" class="headerlink" title="pandas拼接操作"></a>pandas拼接操作</h2><h3 id="级联：pd-concat-pd-append"><a href="#级联：pd-concat-pd-append" class="headerlink" title="级联：pd.concat, pd.append"></a>级联：pd.concat, pd.append</h3><ul>
<li>回顾numpy的级联<pre class="line-numbers language-python" data-language="python"><code class="language-python">x <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span>
y <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span>
z <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span>
display<span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>z<span class="token punctuation">)</span>
np<span class="token punctuation">.</span>concatenate<span class="token punctuation">(</span><span class="token punctuation">[</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>z<span class="token punctuation">]</span><span class="token punctuation">)</span>
输出：
array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
Out<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ul>
<li>练习：<br>生成2个3*3的矩阵，对其分别进行两个维度上的级联<pre class="line-numbers language-none"><code class="language-none">- axis = 0 行

  x = np.random.randn(3,3)
  x
  输出：
  array([[-0.09120671, -0.52299759, -0.16349379],
         [ 0.36666059, -1.3587184 ,  0.81883706],
         [ 1.0621649 ,  0.72906367, -0.41325065]])
  
  np.concatenate([x,x])
  
  输出：
  array([[-0.09120671, -0.52299759, -0.16349379],
         [ 0.36666059, -1.3587184 ,  0.81883706],
         [ 1.0621649 ,  0.72906367, -0.41325065],
         [-0.09120671, -0.52299759, -0.16349379],
         [ 0.36666059, -1.3587184 ,  0.81883706],
         [ 1.0621649 ,  0.72906367, -0.41325065]])

- axis = 1 列

  np.concatenate([x,x],axis=1)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ul>
</li>
</ul>
<pre><code>      输出：
</code></pre>
<pre class="line-numbers language-none"><code class="language-none">array([[-0.09120671, -0.52299759, -0.16349379, -0.09120671, -0.52299759,

        -0.16349379],

       [ 0.36666059, -1.3587184 ,  0.81883706,  0.36666059, -1.3587184 ,

         0.81883706],

       [ 1.0621649 ,  0.72906367, -0.41325065,  1.0621649 ,  0.72906367,

        -0.41325065]])<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ul>
<li>创建生成DataFrame的函数<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">make_df</span><span class="token punctuation">(</span>cols<span class="token punctuation">,</span>ind<span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token triple-quoted-string string">'''
  
    快速生成一个DataFrame
  
    '''</span>
  
    data <span class="token operator">=</span> <span class="token punctuation">{</span>c<span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> ind<span class="token punctuation">]</span> <span class="token keyword">for</span> c <span class="token keyword">in</span> cols<span class="token punctuation">}</span>
  
    <span class="token keyword">return</span> DataFrame<span class="token punctuation">(</span>data<span class="token punctuation">,</span>ind<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ul>
<p>  调用：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">make_df<span class="token punctuation">(</span><span class="token string">'ABC'</span><span class="token punctuation">,</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>


<p>  输出：</p>
<pre class="line-numbers language-none"><code class="language-none">     A	    B	  C

0	A0 	B0	  C0

1	A1	B1	  C1

2	A2 	B2	  C2<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ul>
<li><p>使用pd.concat()级联</p>
<p>pandas使用pd.concat函数，与np.concatenate函数类似，只是多了一些参数：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">pd<span class="token punctuation">.</span>concat<span class="token punctuation">(</span>objs<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> join<span class="token operator">=</span><span class="token string">'outer'</span><span class="token punctuation">,</span> join_axes<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> ignore_index<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>

          keys<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> levels<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> names<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> verify_integrity<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>
  
          copy<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ul>
<li>简单级联<pre class="line-numbers language-none"><code class="language-none">df1 = make_df('AB',[1,2])

df2 = make_df('AB',[3,4])

display(df1,df2,pd.concat([df1,df2]))<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ul>
</li>
</ul>
<pre><code>  输出：
</code></pre>
<p>​      </p>
<pre class="line-numbers language-none"><code class="language-none">	A	B

1	A1	B1

2	A2	B2

A	B

3	A3	B3

4	A4	B4

A	B

1	A1	B1

2	A2	B2

3	A3	B3

4	A4	B4<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre><code>    - 可以通过设置axis来改变级联方向
</code></pre>
<pre class="line-numbers language-none"><code class="language-none">df3 = make_df('WX',[1,3])

df4 = make_df('QT',[5,8])

display(df3,df4,pd.concat([df3,df4],axis=1))<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>


<pre><code>      输出：
</code></pre>
<p>​          </p>
<pre class="line-numbers language-none"><code class="language-none">  		W	X

  1	W1	X1

  3	W3	X3

  		Q	T

  5	Q5	T5

  8	Q8	T8

  		W	X	Q	T

  1	W1	X1	NaN	NaN

  3	W3	X3	NaN	NaN

  5	NaN	NaN	Q5	T5

  8	NaN	NaN	Q8	T8

- 注意index在级联时可以重复

  x = make_df('AB',[0,1])

  y = make_df('AB',[1,8])

  pd.concat([x,y])<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>


<pre><code>      输出：
</code></pre>
<p>​          </p>
<pre class="line-numbers language-none"><code class="language-none">     A	     B

0	A0	 B0

1	A1 	 B1

1	A1  	 B1

8	A8	 B8<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>


<pre><code>      可以选择忽略index，重新索引
</code></pre>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">x <span class="token operator">=</span> make_df<span class="token punctuation">(</span><span class="token string">'AB'</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

y <span class="token operator">=</span> make_df<span class="token punctuation">(</span><span class="token string">'AB'</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

pd<span class="token punctuation">.</span>concat<span class="token punctuation">(</span><span class="token punctuation">[</span>x<span class="token punctuation">,</span>y<span class="token punctuation">]</span><span class="token punctuation">,</span>ignore_index<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>


<pre><code>      输出：
</code></pre>
<p>​           </p>
<pre class="line-numbers language-none"><code class="language-none">     A	     B

0	A0	 B0

1	A1	 B1

2	A4	 B4

3	A8	 B8<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre><code>    - 使用多层索引
</code></pre>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">display<span class="token punctuation">(</span>pd<span class="token punctuation">.</span>concat<span class="token punctuation">(</span><span class="token punctuation">[</span>x<span class="token punctuation">,</span>y<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

display<span class="token punctuation">(</span>pd<span class="token punctuation">.</span>concat<span class="token punctuation">(</span><span class="token punctuation">[</span>x<span class="token punctuation">,</span>y<span class="token punctuation">]</span><span class="token punctuation">,</span>keys<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'x'</span><span class="token punctuation">,</span><span class="token string">'y'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

display<span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span>

display<span class="token punctuation">(</span>pd<span class="token punctuation">.</span>concat<span class="token punctuation">(</span><span class="token punctuation">[</span>x<span class="token punctuation">,</span>y<span class="token punctuation">]</span><span class="token punctuation">,</span>axis <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

display<span class="token punctuation">(</span>pd<span class="token punctuation">.</span>concat<span class="token punctuation">(</span><span class="token punctuation">[</span>x<span class="token punctuation">,</span>y<span class="token punctuation">]</span><span class="token punctuation">,</span>axis <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>keys <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'v'</span><span class="token punctuation">,</span><span class="token string">'r'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>


<pre><code>      输出：
</code></pre>
<p>​          </p>
<pre class="line-numbers language-none"><code class="language-none">	A		B

0	A0	B0

1	A1	B1

1	A1	B1

8	A8	B8





		A		B

x	0	A0	B0

	1	A1	B1

y	1	A1	B1

	8	A8	B8





	A		B

0	A0	B0

1	A1	B1

	A		B

1	A1	B1

8	A8	B8



	A		B		A		B

0	A0	B0		NaN	NaN

1	A1	B1		A1	B1

8	NaN	NaN	A8	B8



	v				r
	
	A		B		A		B

0	A0	B0		NaN	NaN

1	A1	B1		A1	B1

8	NaN	NaN	A8	B8<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre><code>    - 练习题：
</code></pre>
<p>想一想级联的应用场景？<br>使用昨天的知识，建立一个期中考试张三、李四的成绩表ddd<br>假设新增考试学科”计算机”，如何实现？<br>新增王老五同学的成绩，如何实现？</p>
<pre><code>- 不匹配级联

  不匹配指的是级联的维度的索引不一致。例如纵向级联时列索引不一致，横向级联时行索引不一致

    - 外连接：补NaN（默认模式）
</code></pre>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">x <span class="token operator">=</span> make_df<span class="token punctuation">(</span><span class="token string">'ABC'</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

y <span class="token operator">=</span> make_df<span class="token punctuation">(</span><span class="token string">'BCD'</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

display<span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>pd<span class="token punctuation">.</span>concat<span class="token punctuation">(</span><span class="token punctuation">[</span>x<span class="token punctuation">,</span>y<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>


<pre><code>      输出：
</code></pre>
<pre class="line-numbers language-none"><code class="language-none">A	B	C

1	A1	B1	C1

2	A2	B2	C2

B	C	D

3	B3	C3	D3

4	B4	C4	D4

A	B	C	D

1	A1	B1	C1	NaN

2	A2	B2	C2	NaN

3	NaN	B3	C3	D3

4	NaN	B4	C4	D4<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre><code>    - 内连接：只连接匹配的项
</code></pre>
<pre class="line-numbers language-none"><code class="language-none">x = make_df('ABC',[1,2])

y = make_df('BCD',[3,4])

display(x,y,pd.concat([x,y],join="inner"))<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre><code>      输出：
</code></pre>
<pre class="line-numbers language-none"><code class="language-none">		A		B		C

1		A1	B1		C1

2		A2	B2		C2



		B		C		D

3		B3		C3		D3

4		B4		C4		D4



	B		C

1	B1		C1

2	B2		C2

3	B3		C3

4	B4		C4<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre><code>    - 连接指定轴
</code></pre>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">x <span class="token operator">=</span> make_df<span class="token punctuation">(</span><span class="token string">'ABC'</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

y <span class="token operator">=</span> make_df<span class="token punctuation">(</span><span class="token string">'BCD'</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

display<span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>pd<span class="token punctuation">.</span>concat<span class="token punctuation">(</span><span class="token punctuation">[</span>x<span class="token punctuation">,</span>y<span class="token punctuation">]</span><span class="token punctuation">,</span>join_axes<span class="token operator">=</span><span class="token punctuation">[</span>x<span class="token punctuation">.</span>columns<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>


<pre><code>      输出：
</code></pre>
<pre class="line-numbers language-none"><code class="language-none">	A	     B	    C

1	A1	B1	    C1

2	A2	B2 	C2

	B	  C	D

3	B3	 C3	D3

4	B4	 C4	D4



	A	    B	 C

1	A1	B1	 C1

2	A2	B2	 C2

3	NaN	B3	 C3

4	NaN	B4	 C4<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre><code>    - 练习：
</code></pre>
<p>假设【期末】考试ddd2的成绩没有张三的，只有李四、王老五、赵小六的，使用多种方法级联</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>seed<span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span>

a <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">150</span><span class="token punctuation">,</span>size<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

ddd2 <span class="token operator">=</span> DataFrame<span class="token punctuation">(</span>a<span class="token punctuation">,</span>columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"王五"</span><span class="token punctuation">,</span><span class="token string">"李四"</span><span class="token punctuation">,</span><span class="token string">"赵小六"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>

                index <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"语文"</span><span class="token punctuation">,</span><span class="token string">"数学"</span><span class="token punctuation">,</span><span class="token string">"英语"</span><span class="token punctuation">,</span><span class="token string">"理综"</span><span class="token punctuation">,</span><span class="token string">"Python"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>seed<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>

ddd <span class="token operator">=</span> DataFrame<span class="token punctuation">(</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">150</span><span class="token punctuation">,</span>size <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>

                                  columns <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'张三'</span><span class="token punctuation">,</span><span class="token string">'李四'</span><span class="token punctuation">,</span><span class="token string">'小莲'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>

                                  index <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"语文"</span><span class="token punctuation">,</span><span class="token string">"数学"</span><span class="token punctuation">,</span><span class="token string">"英语"</span><span class="token punctuation">,</span><span class="token string">"理综"</span><span class="token punctuation">,</span><span class="token string">"Python"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

display<span class="token punctuation">(</span>ddd2<span class="token punctuation">)</span>

display<span class="token punctuation">(</span>ddd<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>


<pre><code>      输出：
</code></pre>
<pre class="line-numbers language-none"><code class="language-none">王五	李四	赵小六

语文	140	133	119

数学	128	85	118

英语	17	23	62

理综	10	143	105

Python	39	37	19

张三	李四	小莲

语文	9	125	15

数学	64	113	123

英语	113	8	73

理综	0	40	115

Python	16	100	139<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-python" data-language="python"><code class="language-python">df <span class="token operator">=</span> pd<span class="token punctuation">.</span>concat<span class="token punctuation">(</span><span class="token punctuation">[</span>ddd<span class="token punctuation">,</span>ddd2<span class="token punctuation">]</span><span class="token punctuation">,</span>axis <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>ignore_index<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>

df



pd<span class="token punctuation">.</span>concat<span class="token punctuation">(</span><span class="token punctuation">[</span>ddd<span class="token punctuation">,</span>ddd2<span class="token punctuation">]</span><span class="token punctuation">,</span>keys<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"期中"</span><span class="token punctuation">,</span><span class="token string">"期末"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>axis <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>


<ul>
<li><p>使用pd.append()级联</p>
<p>由于在后面级联的使用非常普遍，因此有一个函数append专门用于在后面添加</p>
</li>
</ul>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">x <span class="token operator">=</span> make_df<span class="token punctuation">(</span><span class="token string">'AB'</span><span class="token punctuation">,</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span>size <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

y <span class="token operator">=</span> make_df<span class="token punctuation">(</span><span class="token string">'AB'</span><span class="token punctuation">,</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">,</span>size <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

display<span class="token punctuation">(</span>x<span class="token punctuation">.</span>append<span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>


<p>  输出：</p>
<pre><code>    A             B
</code></pre>
<p>  6      A6          B6</p>
<p>  8      A8          B8</p>
<p>  11  A11          B11</p>
<p>  18     A18          B18</p>
<pre><code>- 练习：
</code></pre>
<p>新建一个只有张三李四王老五的期末考试成绩单ddd3，使用append()与期中考试成绩表ddd级联</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>seed<span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span>

a <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">150</span><span class="token punctuation">,</span>size<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

ddd2 <span class="token operator">=</span> DataFrame<span class="token punctuation">(</span>a<span class="token punctuation">,</span>columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"王五"</span><span class="token punctuation">,</span><span class="token string">"李四"</span><span class="token punctuation">,</span><span class="token string">"赵小六"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>

                index <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"语文"</span><span class="token punctuation">,</span><span class="token string">"数学"</span><span class="token punctuation">,</span><span class="token string">"英语"</span><span class="token punctuation">,</span><span class="token string">"理综"</span><span class="token punctuation">,</span><span class="token string">"Python"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>seed<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>

ddd <span class="token operator">=</span> DataFrame<span class="token punctuation">(</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">150</span><span class="token punctuation">,</span>size <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>

                                  columns <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'张三'</span><span class="token punctuation">,</span><span class="token string">'李四'</span><span class="token punctuation">,</span><span class="token string">'小莲'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
 
                                  index <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"语文"</span><span class="token punctuation">,</span><span class="token string">"数学"</span><span class="token punctuation">,</span><span class="token string">"英语"</span><span class="token punctuation">,</span><span class="token string">"理综"</span><span class="token punctuation">,</span><span class="token string">"Python"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

display<span class="token punctuation">(</span>ddd2<span class="token punctuation">)</span>

display<span class="token punctuation">(</span>ddd<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>


<pre><code>  输出：
</code></pre>
<pre class="line-numbers language-none"><code class="language-none">王五	李四	赵小六

语文	140	133	119

数学	128	85	118

英语	17	23	62

理综	10	143	105

Python	39	37	19

张三	李四	小莲

语文	9	125	15

数学	64	113	123

英语	113	8	73

理综	0	40	115

Python	16	100	139<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-python" data-language="python"><code class="language-python">df <span class="token operator">=</span> pd<span class="token punctuation">.</span>concat<span class="token punctuation">(</span><span class="token punctuation">[</span>ddd<span class="token punctuation">,</span>ddd2<span class="token punctuation">]</span><span class="token punctuation">,</span>axis <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>ignore_index<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>

df



pd<span class="token punctuation">.</span>concat<span class="token punctuation">(</span><span class="token punctuation">[</span>ddd<span class="token punctuation">,</span>ddd2<span class="token punctuation">]</span><span class="token punctuation">,</span>keys<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"期中"</span><span class="token punctuation">,</span><span class="token string">"期末"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>axis <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>


<h3 id="合并：pd-merge"><a href="#合并：pd-merge" class="headerlink" title="合并：pd.merge"></a>合并：pd.merge</h3><ul>
<li><p>使用pd.merge()合并</p>
<p>merge与concat的区别在于，merge需要依据某一共同的行或列来进行合并</p>
<p>使用pd.merge()合并时，会自动根据两者相同column名称的那一列，作为key来进行合并。</p>
<p>注意每一列元素的顺序不要求一致</p>
<ul>
<li>一对一合并<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np

<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

<span class="token keyword">from</span> pandas <span class="token keyword">import</span> Series<span class="token punctuation">,</span>DataFrame

df1 <span class="token operator">=</span> DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'employee'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'Bob'</span><span class="token punctuation">,</span><span class="token string">'Jake'</span><span class="token punctuation">,</span><span class="token string">'Lisa'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>

                <span class="token string">'group'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'Accounting'</span><span class="token punctuation">,</span><span class="token string">'Engineering'</span><span class="token punctuation">,</span><span class="token string">'Engineering'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
 
                <span class="token punctuation">}</span><span class="token punctuation">)</span>

df2 <span class="token operator">=</span> DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'employee'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'Lisa'</span><span class="token punctuation">,</span><span class="token string">'Bob'</span><span class="token punctuation">,</span><span class="token string">'Jake'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>

                <span class="token string">'hire_date'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token number">2004</span><span class="token punctuation">,</span><span class="token number">2008</span><span class="token punctuation">,</span><span class="token number">2012</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
 
                <span class="token punctuation">}</span><span class="token punctuation">)</span>

display<span class="token punctuation">(</span>df1<span class="token punctuation">,</span>df2<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ul>
</li>
</ul>
<pre><code>  输出：
</code></pre>
<p>​      </p>
<pre class="line-numbers language-none"><code class="language-none"> 	employee	group

0	Bob	Accounting

1	Jake	Engineering

2	Lisa	Engineering





	employee	hire_date

0	Lisa	2004

1	Bob	2008

2	Jake	2012





df3 = pd.merge(df1,df2)

df3<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>


<pre><code>  输出：
</code></pre>
<pre class="line-numbers language-none"><code class="language-none">	employee	group	hire_date

0	Bob	Accounting	2008

1	Jake	Engineering	2012

2	Lisa	Engineering	2004<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre><code>- 多对一合并
</code></pre>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">df3 <span class="token operator">=</span> DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span>

    <span class="token string">'employee'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'Lisa'</span><span class="token punctuation">,</span><span class="token string">'Jake'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
 
    <span class="token string">'group'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'Accounting'</span><span class="token punctuation">,</span><span class="token string">'Engineering'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
 
    <span class="token string">'hire_date'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token number">2004</span><span class="token punctuation">,</span><span class="token number">2016</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

df4 <span class="token operator">=</span> DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'group'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'Accounting'</span><span class="token punctuation">,</span><span class="token string">'Engineering'</span><span class="token punctuation">,</span><span class="token string">'Engineering'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>

                       <span class="token string">'supervisor'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'Carly'</span><span class="token punctuation">,</span><span class="token string">'Guido'</span><span class="token punctuation">,</span><span class="token string">'Steve'</span><span class="token punctuation">]</span>
 
                <span class="token punctuation">}</span><span class="token punctuation">)</span>

display<span class="token punctuation">(</span>df3<span class="token punctuation">,</span>df4<span class="token punctuation">,</span>pd<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>df3<span class="token punctuation">,</span>df4<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>


<pre><code>  输出：
</code></pre>
<pre class="line-numbers language-none"><code class="language-none">	employee		group		hire_date

0		Lisa		Accounting		2004

2	 	Jake		Engineering		2016



		group			supervisor

0		Accounting		Carly

1		Engineering		Guido

2		Engineering		Steve



	employee	group	hire_date	supervisor

0	Lisa	Accounting	2004	Carly

1	Jake	Engineering	2016	Guido

2	Jake	Engineering	2016	Steve<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre><code>- 多对多合并
</code></pre>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">df1 <span class="token operator">=</span> DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'employee'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'Bob'</span><span class="token punctuation">,</span><span class="token string">'Jake'</span><span class="token punctuation">,</span><span class="token string">'Lisa'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>

                 <span class="token string">'group'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'Accounting'</span><span class="token punctuation">,</span><span class="token string">'Engineering'</span><span class="token punctuation">,</span><span class="token string">'Engineering'</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

df5 <span class="token operator">=</span> DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'group'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'Engineering'</span><span class="token punctuation">,</span><span class="token string">'Engineering'</span><span class="token punctuation">,</span><span class="token string">'HR'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>

                <span class="token string">'supervisor'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'Carly'</span><span class="token punctuation">,</span><span class="token string">'Guido'</span><span class="token punctuation">,</span><span class="token string">'Steve'</span><span class="token punctuation">]</span>
 
                <span class="token punctuation">}</span><span class="token punctuation">)</span>

display<span class="token punctuation">(</span>df1<span class="token punctuation">,</span>df5<span class="token punctuation">,</span>pd<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>df1<span class="token punctuation">,</span>df5<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">#多对多</span>

display<span class="token punctuation">(</span>pd<span class="token punctuation">.</span>concat<span class="token punctuation">(</span><span class="token punctuation">[</span>df1<span class="token punctuation">,</span>df5<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>


<pre><code>  输出：
</code></pre>
<pre class="line-numbers language-none"><code class="language-none">	employee	group

0	Bob		Accounting

1	Jake		Engineering

2	Lisa		Engineering



	group		supervisor

0	Engineering	Carly

1	Engineering	Guido

2		HR			Steve



employee	group	supervisor

0	Jake	Engineering	Carly

1	Jake	Engineering	Guido

2	Lisa	Engineering	Carly

3	Lisa	Engineering	Guido





   	employee			group		supervisor

0		Bob			Accounting		NaN

1		Jake			Engineering		NaN

2		Lisa			Engineering		NaN

0		NaN			Engineering		Carly

1		NaN			Engineering		Guido

2		NaN					HR			Steve<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre><code>- key的规范化

    - 使用on=显式指定哪一列为key
</code></pre>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">df1 <span class="token operator">=</span> DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'employee'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'Jack'</span><span class="token punctuation">,</span><span class="token string">"Summer"</span><span class="token punctuation">,</span><span class="token string">"Steve"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>

                 <span class="token string">'group'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'Accounting'</span><span class="token punctuation">,</span><span class="token string">'Finance'</span><span class="token punctuation">,</span><span class="token string">'Marketing'</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span>



df2 <span class="token operator">=</span> DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'employee'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'Jack'</span><span class="token punctuation">,</span><span class="token string">'Bob'</span><span class="token punctuation">,</span><span class="token string">"Jake"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>

                 <span class="token string">'hire_date'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token number">2003</span><span class="token punctuation">,</span><span class="token number">2009</span><span class="token punctuation">,</span><span class="token number">2012</span><span class="token punctuation">]</span><span class="token punctuation">,</span>

                <span class="token string">'group'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'Accounting'</span><span class="token punctuation">,</span><span class="token string">'sell'</span><span class="token punctuation">,</span><span class="token string">'ceo'</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

display<span class="token punctuation">(</span>df1<span class="token punctuation">,</span>df2<span class="token punctuation">,</span>pd<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>df1<span class="token punctuation">,</span>df2<span class="token punctuation">)</span><span class="token punctuation">,</span>pd<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>df1<span class="token punctuation">,</span>df2<span class="token punctuation">,</span>on <span class="token operator">=</span> <span class="token string">'employee'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>


<pre><code>      输出：
</code></pre>
<p>​          </p>
<pre class="line-numbers language-none"><code class="language-none">employee	group

0	Jack	Accounting

1	Summer	Finance

2	Steve	Marketing





employee	group	hire_date

0	Jack	Accounting	2003

1	Bob	sell	2009

2	Jake	ceo	2012



employee	group	hire_date

0	Jack	Accounting	2003



	employee	 group_x	group_y	hire_date

0	Jack 		Accounting	Accounting	2003<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre><code>    - 使用left_on和right_on指定左右两边的列作为key
</code></pre>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">df1 <span class="token operator">=</span> DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'employee'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'Bobs'</span><span class="token punctuation">,</span><span class="token string">'Linda'</span><span class="token punctuation">,</span><span class="token string">'Bill'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>

                <span class="token string">'group'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'Accounting'</span><span class="token punctuation">,</span><span class="token string">'Product'</span><span class="token punctuation">,</span><span class="token string">'Marketing'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>

               <span class="token string">'hire_date'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token number">1998</span><span class="token punctuation">,</span><span class="token number">2017</span><span class="token punctuation">,</span><span class="token number">2018</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

df5 <span class="token operator">=</span> DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'name'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'Lisa'</span><span class="token punctuation">,</span><span class="token string">'Bobs'</span><span class="token punctuation">,</span><span class="token string">'Bill'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>

                <span class="token string">'hire_dates'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token number">1998</span><span class="token punctuation">,</span><span class="token number">2016</span><span class="token punctuation">,</span><span class="token number">2007</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span>



display<span class="token punctuation">(</span>df1<span class="token punctuation">,</span>df5<span class="token punctuation">,</span>pd<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>df1<span class="token punctuation">,</span>df5<span class="token punctuation">,</span>left_on <span class="token operator">=</span> <span class="token string">'employee'</span><span class="token punctuation">,</span>right_on <span class="token operator">=</span> <span class="token string">'name'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>


<p>​          </p>
<pre><code>      输出：
</code></pre>
<pre class="line-numbers language-none"><code class="language-none">	employee	group		hire_date

0		Bobs	Accounting	1998

1		Linda	Product			2017

2		Bill	Marketing			2018



 hire_dates	 	name

0	1998			Lisa

1	2016			Bobs

2	2007			Bill





employee	group	hire_date	hire_dates	name

0	Bobs	Accounting	1998	2016	Bobs

1	Bill	Marketing	2018	2007	Bill<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre><code>    - 练习：
</code></pre>
<p>假设有两份成绩单，除了ddd是张三李四王老五之外，还有ddd4是张三和赵小六的成绩单，如何合并？<br>如果ddd4中张三的名字被打错了，成为了张十三，怎么办？<br>自行练习多对一，多对多的情况</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">a1 <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">122</span><span class="token punctuation">,</span><span class="token number">107</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">,</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">110</span><span class="token punctuation">,</span><span class="token number">38</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">128</span><span class="token punctuation">,</span><span class="token number">111</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">50</span><span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

ddd1 <span class="token operator">=</span> DataFrame<span class="token punctuation">(</span>a1<span class="token punctuation">,</span>columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"张三"</span><span class="token punctuation">,</span><span class="token string">"李四"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>

                index <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"语文"</span><span class="token punctuation">,</span><span class="token string">"数学"</span><span class="token punctuation">,</span><span class="token string">"英语"</span><span class="token punctuation">,</span><span class="token string">"理综"</span><span class="token punctuation">,</span><span class="token string">"计算机"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>



a2 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">122</span><span class="token punctuation">,</span><span class="token number">120</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">,</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">110</span><span class="token punctuation">,</span><span class="token number">95</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">128</span><span class="token punctuation">,</span><span class="token number">61</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">50</span><span class="token punctuation">,</span><span class="token number">45</span><span class="token punctuation">]</span><span class="token punctuation">]</span>

ddd2 <span class="token operator">=</span> DataFrame<span class="token punctuation">(</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span>size <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"李四"</span><span class="token punctuation">,</span><span class="token string">"赵小六"</span><span class="token punctuation">,</span><span class="token string">'张五'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>

                index <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"语文"</span><span class="token punctuation">,</span><span class="token string">"数学"</span><span class="token punctuation">,</span><span class="token string">"英语"</span><span class="token punctuation">,</span><span class="token string">"理综"</span><span class="token punctuation">,</span><span class="token string">"计算机"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

display<span class="token punctuation">(</span>ddd1<span class="token punctuation">,</span>ddd2<span class="token punctuation">)</span>

pd<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>ddd1<span class="token punctuation">,</span>ddd2<span class="token punctuation">,</span>left_index <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">,</span>right_index <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">,</span>on <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'李四'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>


<pre><code>      输出：
</code></pre>
<pre class="line-numbers language-none"><code class="language-none">			张三		李四

语文		122		107

数学		21			14

英语		110		38

理综		128		111

计算机		50		50



		李四		赵小六		张五

语文		95			76			85

数学		89			15			4

英语		28			79			21

理综		99			58			28

计算机	21			5			58





Out[94]:

			张三		李四		赵小六	张五

语文		122		107		76			85  

数学		21			14			15			4    

英语		110		38			79			21  

理综		128		111		58			28  

计算机	50			50			5			58  <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>


<p>​          </p>
<pre><code>- 内合并与外合并

    - 内合并：只保留两者都有的key（默认模式）
</code></pre>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">df6 <span class="token operator">=</span> DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'name'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'Peter'</span><span class="token punctuation">,</span><span class="token string">'Paul'</span><span class="token punctuation">,</span><span class="token string">'Mary'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>

               <span class="token string">'food'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'fish'</span><span class="token punctuation">,</span><span class="token string">'beans'</span><span class="token punctuation">,</span><span class="token string">'bread'</span><span class="token punctuation">]</span><span class="token punctuation">}</span>

               <span class="token punctuation">)</span>

df7 <span class="token operator">=</span> DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'name'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'Mary'</span><span class="token punctuation">,</span><span class="token string">'Joseph'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>

                <span class="token string">'drink'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'wine'</span><span class="token punctuation">,</span><span class="token string">'beer'</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

display<span class="token punctuation">(</span>df6<span class="token punctuation">,</span>df7<span class="token punctuation">,</span>pd<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>df6<span class="token punctuation">,</span>df7<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>


<pre><code>      输出：
</code></pre>
<p>​          </p>
<pre class="line-numbers language-none"><code class="language-none">	food	name

0	fish	Peter

1	beans	Paul

2	bread	Mary



	drink	name

0	wine	Mary

1	beer	Joseph



	food		name	drink

0	bread	Mary		winee<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre><code>    - 外合并 how='outer'：补NaN
</code></pre>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">df6 <span class="token operator">=</span> DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'name'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'Peter'</span><span class="token punctuation">,</span><span class="token string">'Paul'</span><span class="token punctuation">,</span><span class="token string">'Mary'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>

               <span class="token string">'food'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'fish'</span><span class="token punctuation">,</span><span class="token string">'beans'</span><span class="token punctuation">,</span><span class="token string">'bread'</span><span class="token punctuation">]</span><span class="token punctuation">}</span>

               <span class="token punctuation">)</span>

df7 <span class="token operator">=</span> DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'name'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'Mary'</span><span class="token punctuation">,</span><span class="token string">'Joseph'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>

                <span class="token string">'drink'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'wine'</span><span class="token punctuation">,</span><span class="token string">'beer'</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

display<span class="token punctuation">(</span>df6<span class="token punctuation">,</span>df7<span class="token punctuation">,</span>pd<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>df6<span class="token punctuation">,</span>df7<span class="token punctuation">,</span>how<span class="token operator">=</span><span class="token string">'outer'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>


<p>​          </p>
<pre><code>      输出：
</code></pre>
<pre class="line-numbers language-none"><code class="language-none">	food	name

0	fish	Peter

1	beans	Paul

2	bread	Mary



	drink	name

0	wine	Mary

1	beer	Joseph



 	 food		name		drink 

0	fish			Peter		NaN  

1	beans		Paul			NaN  

2	bread		Mary	 		wine 

3	NaN		  Joseph		beer  <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre><code>    - 左合并、右合并：how='left'，how='right'
</code></pre>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">df6 <span class="token operator">=</span> DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'name'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'Peter'</span><span class="token punctuation">,</span><span class="token string">'Paul'</span><span class="token punctuation">,</span><span class="token string">'Mary'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>

               <span class="token string">'food'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'fish'</span><span class="token punctuation">,</span><span class="token string">'beans'</span><span class="token punctuation">,</span><span class="token string">'bread'</span><span class="token punctuation">]</span><span class="token punctuation">}</span>

               <span class="token punctuation">)</span>

df7 <span class="token operator">=</span> DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'name'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'Mary'</span><span class="token punctuation">,</span><span class="token string">'Joseph'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>

                <span class="token string">'drink'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'wine'</span><span class="token punctuation">,</span><span class="token string">'beer'</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

display<span class="token punctuation">(</span>df6<span class="token punctuation">,</span>df7<span class="token punctuation">,</span>pd<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>df6<span class="token punctuation">,</span>df7<span class="token punctuation">,</span>how<span class="token operator">=</span><span class="token string">'left'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

display<span class="token punctuation">(</span>df6<span class="token punctuation">,</span>df7<span class="token punctuation">,</span>pd<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>df6<span class="token punctuation">,</span>df7<span class="token punctuation">,</span>how<span class="token operator">=</span><span class="token string">'right'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>


<pre><code>      输出：
</code></pre>
<pre class="line-numbers language-none"><code class="language-none">	food		name

0	fish		Peter

1	beans	Paul

2	bread	Mary



	drink	name

0	wine		Mary

1	beer		Joseph



	food		name	drink	

0	fish		Peter	NaN		

1	beans	Paul		NaN		

2	bread	Mary		wine		





	food		name	drink	

0	bread	Mary		wine		

1	NaN		Joseph	beer		<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre><code>    - 练习：
</code></pre>
<p>如果只有张三赵小六语数英三个科目的成绩，如何合并？<br>考虑应用情景，使用多种方式合并ddd与ddd4</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np

<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

<span class="token keyword">from</span> pandas <span class="token keyword">import</span> Series<span class="token punctuation">,</span>DataFrame

np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>seed<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>

df1 <span class="token operator">=</span> DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'张三'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token number">127</span><span class="token punctuation">,</span><span class="token number">119</span><span class="token punctuation">,</span><span class="token number">99</span><span class="token punctuation">,</span><span class="token number">119</span><span class="token punctuation">,</span><span class="token number">73</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">'李四'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token number">125</span><span class="token punctuation">,</span><span class="token number">64</span><span class="token punctuation">,</span><span class="token number">123</span><span class="token punctuation">,</span><span class="token number">99</span><span class="token punctuation">,</span><span class="token number">139</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">,</span>

                index <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'语文'</span><span class="token punctuation">,</span><span class="token string">'数学'</span><span class="token punctuation">,</span><span class="token string">'英语'</span><span class="token punctuation">,</span><span class="token string">'理综'</span><span class="token punctuation">,</span><span class="token string">'编程'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>columns <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'张三'</span><span class="token punctuation">,</span><span class="token string">'李四'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>



df2 <span class="token operator">=</span> DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'张三'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token number">122</span><span class="token punctuation">,</span><span class="token number">21</span><span class="token punctuation">,</span><span class="token number">110</span><span class="token punctuation">]</span><span class="token punctuation">,</span>

                 <span class="token string">'赵小六'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token number">78</span><span class="token punctuation">,</span><span class="token number">96</span><span class="token punctuation">,</span><span class="token number">83</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">,</span>

                 index <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'语文'</span><span class="token punctuation">,</span><span class="token string">'数学'</span><span class="token punctuation">,</span><span class="token string">'英语'</span><span class="token punctuation">]</span>

                <span class="token punctuation">)</span>

display<span class="token punctuation">(</span>df1<span class="token punctuation">,</span>df2<span class="token punctuation">)</span>

pd<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>df1<span class="token punctuation">,</span>df2<span class="token punctuation">,</span>how <span class="token operator">=</span> <span class="token string">'left'</span><span class="token punctuation">,</span>on <span class="token operator">=</span> <span class="token string">'张三'</span><span class="token punctuation">,</span>left_index <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">,</span>right_index <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre><code>      输出：
</code></pre>
<pre class="line-numbers language-none"><code class="language-none">			张三		李四

语文		127		125

数学		119		64

英语		99			123

理综		119		99

编程		73			139



			张三		赵小六

语文		122		78

数学		21			96

英语		110		83



Out[56]:

			张三		李四		赵小六

语文		127		125		78.0

数学		119		64			96.0

英语		99			123		83.0

理综		119		99			NaN

编程		73			139		NaN<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre><code>- 列冲突的解决

    - 当列冲突时，即有多个列名称相同时，需要使用on=来指定哪一个列作为key
</code></pre>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">df8 <span class="token operator">=</span> DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'name'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'Peter'</span><span class="token punctuation">,</span><span class="token string">'Paul'</span><span class="token punctuation">,</span><span class="token string">'Mary'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>

                <span class="token string">'rank'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

df9 <span class="token operator">=</span> DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'name'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'Peter'</span><span class="token punctuation">,</span><span class="token string">'Paul'</span><span class="token punctuation">,</span><span class="token string">'Mary'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>

                <span class="token string">'rank'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

display<span class="token punctuation">(</span>df8<span class="token punctuation">,</span>df9<span class="token punctuation">,</span>pd<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>df8<span class="token punctuation">,</span>df9<span class="token punctuation">,</span>on <span class="token operator">=</span> <span class="token string">'name'</span><span class="token punctuation">,</span>suffixes<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'rank_L'</span><span class="token punctuation">,</span><span class="token string">'rank_R'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>


<pre><code>      输出：
</code></pre>
<pre class="line-numbers language-none"><code class="language-none">	name	rank

0	Peter	1

1	Paul		2

2	Mary		3

name	rank

0	Peter	5

1	Paul		6

2	Mary		7



	name	rankrank_L	rankrank_R

0	Peter		1					5			

1	Paul			2					6			

2	Mary			3					7			<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre><code>    - 练习：
</code></pre>
<p>假设有两个同学都叫李四，ddd5、ddd6都是张三和李四的成绩表，如何合并？</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>seed<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span>

df4 <span class="token operator">=</span> DataFrame<span class="token punctuation">(</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">150</span><span class="token punctuation">,</span>size <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>

               columns <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'张三'</span><span class="token punctuation">,</span><span class="token string">'李四'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>

               index <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'语文'</span><span class="token punctuation">,</span><span class="token string">'数学'</span><span class="token punctuation">,</span><span class="token string">'英语'</span><span class="token punctuation">,</span><span class="token string">'理综'</span><span class="token punctuation">,</span><span class="token string">'计算机'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

df5 <span class="token operator">=</span> DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'张三'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">67</span><span class="token punctuation">,</span><span class="token number">87</span><span class="token punctuation">,</span><span class="token number">128</span><span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">]</span><span class="token punctuation">,</span>

                 <span class="token string">'李四'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">,</span><span class="token number">103</span><span class="token punctuation">,</span><span class="token number">83</span><span class="token punctuation">,</span><span class="token number">45</span><span class="token punctuation">,</span><span class="token number">58</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">,</span>

                 index <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'语文'</span><span class="token punctuation">,</span><span class="token string">'数学'</span><span class="token punctuation">,</span><span class="token string">'英语'</span><span class="token punctuation">,</span><span class="token string">'理综'</span><span class="token punctuation">,</span><span class="token string">'计算机'</span><span class="token punctuation">]</span>

                <span class="token punctuation">)</span>

display<span class="token punctuation">(</span>df4<span class="token punctuation">,</span>df5<span class="token punctuation">)</span>

pd<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>df4<span class="token punctuation">,</span>df5<span class="token punctuation">,</span>left_index <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">,</span>right_index <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">,</span>suffixes<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'-期中'</span><span class="token punctuation">,</span><span class="token string">'-期末'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>


<p>​          </p>
<pre><code>      输出：
</code></pre>
<pre class="line-numbers language-none"><code class="language-none">			张三	李四

语文		8		24

数学		67		103

英语		87		79

理综		138	94

计算机	98		53



		张三		李四

语文		8		24

数学		67		103

英语		87		83

理综		128	45

计算机	50		58





	张三-期中	李四-期中	张三-期末	李四-期末

语文	8	24	8	24

数学	67	103	67	103

英语	87	79	87	83

理综	138	94	128	45

计算机	98	53	50	58		<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="pandas案例"><a href="#pandas案例" class="headerlink" title="pandas案例"></a>pandas案例</h2><h3 id="美国各州人口数据分析"><a href="#美国各州人口数据分析" class="headerlink" title="美国各州人口数据分析"></a>美国各州人口数据分析</h3><ul>
<li>首先导入文件，并查看数据样本<pre class="line-numbers language-python" data-language="python"><code class="language-python">pop <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'../../data/state-population.csv'</span><span class="token punctuation">)</span>

areas <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'../../data/state-areas.csv'</span><span class="token punctuation">)</span>

abbrevs <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'../../data/state-abbrevs.csv'</span><span class="token punctuation">)</span>

display<span class="token punctuation">(</span>pop<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>areas<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>abbrevs<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ul>
<p>  输出：</p>
<pre class="line-numbers language-none"><code class="language-none">state/region	ages	year	population

0	AL	under18	2012	1117489.0

1	AL	total	2012	4817528.0

2	AL	under18	2010	1130966.0

3	AL	total	2010	4785570.0

4	AL	under18	2011	1125763.0



state	area (sq. mi)

0	Alabama	52423

1	Alaska	656425

2	Arizona	114006

3	Arkansas	53182

4	California	163707





state	abbreviation

0	Alabama	AL

1	Alaska	AK

2	Arizona	AZ

3	Arkansas	AR

4	California	CA<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ul>
<li>合并pop与abbrevs两个DataFrame，分别依据state/region列和abbreviation列来合并。<br>为了保留所有信息，使用外合并<pre class="line-numbers language-python" data-language="python"><code class="language-python">merged <span class="token operator">=</span> pd<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>pop<span class="token punctuation">,</span>abbrevs<span class="token punctuation">,</span>how<span class="token operator">=</span><span class="token string">'outer'</span><span class="token punctuation">,</span>left_on <span class="token operator">=</span> <span class="token string">'state/region'</span><span class="token punctuation">,</span>right_on <span class="token operator">=</span> <span class="token string">'abbreviation'</span><span class="token punctuation">)</span>

merged2 <span class="token operator">=</span> pd<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>pop<span class="token punctuation">,</span>abbrevs<span class="token punctuation">,</span>left_on <span class="token operator">=</span> <span class="token string">'state/region'</span><span class="token punctuation">,</span>right_on <span class="token operator">=</span> <span class="token string">'abbreviation'</span><span class="token punctuation">)</span>

display<span class="token punctuation">(</span>merged<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>merged2<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ul>
<p>  输出：</p>
<pre class="line-numbers language-none"><code class="language-none">state/region	ages	year	population	state	abbreviation

0	AL	under18	2012	1117489.0	Alabama	AL

1	AL	total	2012	4817528.0	Alabama	AL

2	AL	under18	2010	1130966.0	Alabama	AL

3	AL	total	2010	4785570.0	Alabama	AL

4	AL	under18	2011	1125763.0	Alabama	AL





state/region	ages	year	population	state	abbreviation

0	AL	under18	2012	1117489.0	Alabama	AL

1	AL	total	2012	4817528.0	Alabama	AL

2	AL	under18	2010	1130966.0	Alabama	AL

3	AL	total	2010	4785570.0	Alabama	AL

4	AL	under18	2011	1125763.0	Alabama	AL<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ul>
<li>去除abbreviation的那一列（axis=1）<pre class="line-numbers language-python" data-language="python"><code class="language-python">merged <span class="token operator">=</span> merged<span class="token punctuation">.</span>drop<span class="token punctuation">(</span><span class="token string">'abbreviation'</span><span class="token punctuation">,</span>axis <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span>

merged<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></li>
</ul>
<p>  输出：</p>
<pre class="line-numbers language-none"><code class="language-none">state/region	ages	year	population	state

0	AL	under18	2012	1117489.0	Alabama

1	AL	total	2012	4817528.0	Alabama

2	AL	under18	2010	1130966.0	Alabama

3	AL	total	2010	4785570.0	Alabama

4	AL	under18	2011	1125763.0	Alabama<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ul>
<li>查看存在缺失数据的列。<br>使用.isnull().any()，只有某一列存在一个缺失数据，就会显示True。<pre class="line-numbers language-python" data-language="python"><code class="language-python">merged<span class="token punctuation">.</span>isnull<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">any</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li>
</ul>
<p>  输出：</p>
<pre class="line-numbers language-none"><code class="language-none">  state/region    False

  ages            False

  year            False

  population       True

  state            True

  dtype: bool

- 查看缺失数据的例子

  # display(merged['population'].isnull()) # 查看列population 缺失数据 如果缺失返回null

  merged[merged['population'].isnull()] #根据数据是否缺失情况显示数据，如果缺失为True，那么显示<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>


<p>  输出：</p>
<pre class="line-numbers language-none"><code class="language-none">	state/region	ages	year	population	state

2448	PR	under18	1990	NaN	NaN

2449	PR	total	1990	NaN	NaN

2450	PR	total	1991	NaN	NaN

2451	PR	under18	1991	NaN	NaN

2452	PR	total	1993	NaN	NaN

2453	PR	under18	1993	NaN	NaN

2454	PR	under18	1992	NaN	NaN

2455	PR	total	1992	NaN	NaN

2456	PR	under18	1994	NaN	NaN

2457	PR	total	1994	NaN	NaN

2458	PR	total	1995	NaN	NaN

2459	PR	under18	1995	NaN	NaN

2460	PR	under18	1996	NaN	NaN

2461	PR	total	1996	NaN	NaN

2462	PR	under18	1998	NaN	NaN

2463	PR	total	1998	NaN	NaN

2464	PR	total	1997	NaN	NaN

2465	PR	under18	1997	NaN	NaN

2466	PR	total	1999	NaN	NaN

2467	PR	under18	1999	NaN	NaN<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ul>
<li>找到有哪些state/region使得state的值为NaN，使用unique()去重<pre class="line-numbers language-python" data-language="python"><code class="language-python">s <span class="token operator">=</span> merged<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>merged<span class="token punctuation">[</span><span class="token string">'state'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>isnull<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'state/region'</span><span class="token punctuation">]</span>

ss <span class="token operator">=</span> s<span class="token punctuation">.</span>unique<span class="token punctuation">(</span><span class="token punctuation">)</span>

display<span class="token punctuation">(</span>s<span class="token punctuation">,</span>ss<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ul>
<p>  输出：</p>
<pre><code>  2448     PR

  2449     PR

  2450     PR

  2451     PR

  2452     PR

  2453     PR

  2454     PR

  2455     PR

  2456     PR

  2457     PR

  2458     PR

  2459     PR

  2460     PR

  2461     PR

  2462     PR

  2463     PR

  2464     PR

  2465     PR

  2466     PR

  2467     PR

  2468     PR

  2469     PR

  2470     PR

  2471     PR

  2472     PR

  2473     PR

  2474     PR

  2475     PR

  2476     PR

  2477     PR

         ... 

  2514    USA

  2515    USA

  2516    USA

  2517    USA

  2518    USA

  2519    USA

  2520    USA

  2521    USA

  2522    USA

  2523    USA

  2524    USA

  2525    USA

  2526    USA

  2527    USA

  2528    USA

  2529    USA

  2530    USA

  2531    USA

  2532    USA

  2533    USA

  2534    USA

  2535    USA

  2536    USA

  2537    USA

  2538    USA

  2539    USA

  2540    USA

  2541    USA

  2542    USA

  2543    USA

  Name: state/region, Length: 96, dtype: object
<pre class="line-numbers language-none"><code class="language-none">  //////////////////////////////////////////////////////////////////////////////
```python
  array(['PR', 'USA'], dtype=object)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
- 为找到的这些state/region的state项补上正确的值，从而去除掉state这一列的所有NaN！
记住这样清除缺失数据NaN的方法！
<pre class="line-numbers language-python" data-language="python"><code class="language-python">merged<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>merged<span class="token punctuation">[</span><span class="token string">'state/region'</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token string">'PR'</span><span class="token punctuation">,</span><span class="token string">'state'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'Puerto Rico'</span>

merged<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>merged<span class="token punctuation">[</span><span class="token string">'state/region'</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token string">'USA'</span><span class="token punctuation">,</span><span class="token string">'state'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'United States'</span>

merged<span class="token punctuation">.</span>isnull<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">any</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>


  输出：
<pre class="line-numbers language-none"><code class="language-none">state/region    False

ages            False

year            False

population       True

state           False

dtype: bool<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
- 合并各州面积数据areas，使用左合并。
思考一下为什么使用左合并？
<pre class="line-numbers language-python" data-language="python"><code class="language-python">display<span class="token punctuation">(</span>merged<span class="token punctuation">.</span>shape<span class="token punctuation">,</span>areas<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>

df1 <span class="token operator">=</span> pd<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>merged<span class="token punctuation">,</span>areas<span class="token punctuation">,</span>on <span class="token operator">=</span> <span class="token string">'state'</span><span class="token punctuation">)</span>

df2 <span class="token operator">=</span> pd<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>merged<span class="token punctuation">,</span>areas<span class="token punctuation">,</span>on <span class="token operator">=</span> <span class="token string">'state'</span><span class="token punctuation">,</span>how <span class="token operator">=</span> <span class="token string">'left'</span><span class="token punctuation">)</span>

display<span class="token punctuation">(</span>df1<span class="token punctuation">.</span>shape<span class="token punctuation">,</span>df2<span class="token punctuation">.</span>shape<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>


  输出：
<pre class="line-numbers language-none"><code class="language-none">  (2544, 5)

  (52, 2)

  (2496, 6)

  (2544, 6)

- 继续寻找存在缺失数据的列

  final.isnull().any()

  输出：

  state/region     False

  ages             False

  year             False

  population        True

  state            False

  area (sq. mi)     True

  dtype: bool<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
- 我们会发现area(sq.mi)这一列有缺失数据，为了找出是哪一行，我们需要找出是哪个state没有数据
<pre class="line-numbers language-python" data-language="python"><code class="language-python">s1 <span class="token operator">=</span> df2<span class="token punctuation">[</span><span class="token string">'state'</span><span class="token punctuation">]</span><span class="token punctuation">[</span>df2<span class="token punctuation">[</span><span class="token string">'area (sq. mi)'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>isnull<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span>

display<span class="token punctuation">(</span>s1<span class="token punctuation">.</span>shape<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>


  输出：
<pre class="line-numbers language-none"><code class="language-none">(48,)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
- 去除含有缺失数据的行
<pre class="line-numbers language-python" data-language="python"><code class="language-python">display<span class="token punctuation">(</span>df2<span class="token punctuation">.</span>shape<span class="token punctuation">,</span>df2<span class="token punctuation">.</span>dropna<span class="token punctuation">(</span>inplace <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">,</span>df2<span class="token punctuation">.</span>shape<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>


  输出：
<pre class="line-numbers language-none"><code class="language-none">(2544, 6)

None

(2476, 6)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
- 找出2010年的全民人口数据
<pre class="line-numbers language-python" data-language="python"><code class="language-python">display<span class="token punctuation">(</span>df2<span class="token punctuation">.</span>shape<span class="token punctuation">,</span><span class="token builtin">type</span><span class="token punctuation">(</span>df2<span class="token punctuation">)</span><span class="token punctuation">)</span>

data2010 <span class="token operator">=</span> df2<span class="token punctuation">.</span>query<span class="token punctuation">(</span><span class="token string">"year == 2010 &amp; ages == 'total'"</span><span class="token punctuation">)</span>

data2010<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>


  输出：
<pre class="line-numbers language-none"><code class="language-none">(2476, 6)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">pandas<span class="token punctuation">.</span>core<span class="token punctuation">.</span>frame<span class="token punctuation">.</span>DataFrame<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<pre class="line-numbers language-none"><code class="language-none">Out[122]:

state/region	ages	year	population	state	area (sq. mi)

3	AL	total	2010	4785570.0	Alabama	52423.0

91	AK	total	2010	713868.0	Alaska	656425.0

101	AZ	total	2010	6408790.0	Arizona	114006.0

189	AR	total	2010	2922280.0	Arkansas	53182.0

197	CA	total	2010	37333601.0	California	163707.0<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
- 对查询结果进行处理，以state列作为新的行索引
<pre class="line-numbers language-python" data-language="python"><code class="language-python">data2010<span class="token punctuation">.</span>set_index<span class="token punctuation">(</span><span class="token string">'state'</span><span class="token punctuation">,</span>inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

display<span class="token punctuation">(</span>data2010<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>

data2010<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>




  输出：
<pre class="line-numbers language-none"><code class="language-none">(52, 5)

Out[134]:

state/region	ages	year	population	area (sq. mi)

state					

Alabama	AL	total	2010	4785570.0	52423.0

Alaska	AK	total	2010	713868.0	656425.0

Arizona	AZ	total	2010	6408790.0	114006.0

Arkansas	AR	total	2010	2922280.0	53182.0

California	CA	total	2010	37333601.0	163707.0<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
- 计算人口密度。注意是Series/Series，其结果还是一个Series
<pre class="line-numbers language-python" data-language="python"><code class="language-python">density <span class="token operator">=</span> data2010<span class="token punctuation">[</span><span class="token string">'population'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>div<span class="token punctuation">(</span>data2010<span class="token punctuation">[</span><span class="token string">'area (sq. mi)'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">#出发运算</span>

display<span class="token punctuation">(</span>data2010<span class="token punctuation">.</span>shape<span class="token punctuation">,</span><span class="token builtin">type</span><span class="token punctuation">(</span>data2010<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token builtin">type</span><span class="token punctuation">(</span>df2<span class="token punctuation">)</span><span class="token punctuation">,</span>density<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token builtin">type</span><span class="token punctuation">(</span>density<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>


  输出：
<pre class="line-numbers language-none"><code class="language-none">(52, 5)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">pandas<span class="token punctuation">.</span>core<span class="token punctuation">.</span>frame<span class="token punctuation">.</span>DataFrame

pandas<span class="token punctuation">.</span>core<span class="token punctuation">.</span>frame<span class="token punctuation">.</span>DataFrame<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-none"><code class="language-none">state

Alabama        91.287603

Alaska          1.087509

Arizona        56.214497

Arkansas       54.948667

California    228.051342<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">dtype<span class="token punctuation">:</span> float64

pandas<span class="token punctuation">.</span>core<span class="token punctuation">.</span>series<span class="token punctuation">.</span>Series<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
- 排序，并找出人口密度最高的五个州
<pre class="line-numbers language-python" data-language="python"><code class="language-python">display<span class="token punctuation">(</span>density<span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span>ascending<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>inplace <span class="token operator">=</span> <span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>


  输出：
<pre class="line-numbers language-none"><code class="language-none">state

District of Columbia    8898.897059

Puerto Rico             1058.665149

New Jersey              1009.253268

Rhode Island             681.339159

Connecticut              645.600649

dtype: float64<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
- 排序，并找出人口密度最低的五个州
<pre class="line-numbers language-python" data-language="python"><code class="language-python">display<span class="token punctuation">(</span>density<span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span>ascending<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">.</span>tail<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>


  输出：
<pre class="line-numbers language-none"><code class="language-none">state

South Dakota    10.583512

North Dakota     9.537565

Montana          6.736171

Wyoming          5.768079

Alaska           1.087509

dtype: float64<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
- 要点总结：
统一用loc()索引
善于使用.isnull().any()找到存在NaN的列
善于使用.unique()确定该列中哪些key是我们需要的
一般使用外合并、左合并，目的只有一个：宁愿该列是NaN也不要丢弃其他列的信息

## 回顾：Series/DataFrame运算与ndarray运算的区别

### ndarray有广播，通过重复已有值来计算
<pre class="line-numbers language-python" data-language="python"><code class="language-python">a <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
b <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
display<span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>a<span class="token operator">+</span>b<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
输出：
<pre class="line-numbers language-none"><code class="language-none">array([1, 2, 3])
array([2])
array([3, 4, 5])<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
### Series与DataFrame没有广播，如果对应index没有值，则记为NaN；或者使用add的fill_value来补缺失值

- Series
<pre class="line-numbers language-python" data-language="python"><code class="language-python">s <span class="token operator">=</span> Series<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
s2 <span class="token operator">=</span> Series<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
display<span class="token punctuation">(</span>s<span class="token punctuation">,</span>s<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>s<span class="token operator">+</span>s2<span class="token punctuation">)</span>
display<span class="token punctuation">(</span>s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>s2<span class="token punctuation">,</span>fill_value<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
  输出：
  <pre class="line-numbers language-none"><code class="language-none">0    1
1    2
2    3
dtype: int64
0    2
1    3
2    4
dtype: int64
0    3.0
1    NaN
2    NaN
dtype: float64
0    3.0
1    2.0
2    3.0
dtype: float64<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
- DataFrame
<pre class="line-numbers language-python" data-language="python"><code class="language-python">df <span class="token operator">=</span> DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'A'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
               <span class="token string">'B'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
df2 <span class="token operator">=</span> DataFrame<span class="token punctuation">(</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span>size <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'B'</span><span class="token punctuation">,</span><span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
display<span class="token punctuation">(</span>df<span class="token punctuation">,</span>df2<span class="token punctuation">,</span>df<span class="token operator">+</span>df2<span class="token punctuation">,</span>df<span class="token punctuation">.</span>add<span class="token punctuation">(</span>df2<span class="token punctuation">,</span>fill_value <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>df2<span class="token punctuation">.</span>add<span class="token punctuation">(</span>df<span class="token punctuation">,</span>fill_value <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
  输出：
  <pre class="line-numbers language-none"><code class="language-none">	A	B
0	1	4
1	2	5
2	3	6
	B	c
0	8	4
1	7	0
2	2	8

	A		B			c
0	NaN	12		NaN
1	NaN	12		NaN
2	NaN	 8		NaN

	A		B		c
0	1.0	12		4.0
1	2.0	12		0.0
2	3.0	8		8.0

	A		B		c
0	1		12		4
1	2		12		0
2	3		8		8<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</code></pre>

                
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        文章作者:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="/about" rel="external nofollow noreferrer">Cya Wu</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        文章链接:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="http://cyawu.github.io/2021/03/04/Day3-pandas-%E2%85%A1/">http://cyawu.github.io/2021/03/04/Day3-pandas-%E2%85%A1/</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        版权声明:
                    </i>
                </span>
                <span class="reprint-info">
                    本博客所有文章除特別声明外，均采用
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    许可协议。转载请注明来源
                    <a href="/about" target="_blank">Cya Wu</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            
                                <a href="/tags/Pandas/">
                                    <span class="chip bg-color">Pandas</span>
                                </a>
                            
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">
<div id="article-share">

    
    <div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div>
    <script src="/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
        </div>
    </div>

    

    

    

    

    

    

    

    
        <style>
    .twikoo-card {
        margin: 1.5rem auto;
    }

    .twikoo-card .card-content {
        padding: 20px;
    }

    #tcomments textarea {
        box-sizing: border-box;
        background: url("/") 100% 100% no-repeat;
    }

    #tcomments p {
        margin: 2px 2px 10px;
        font-size: 1.05rem;
        line-height: 1.78rem;
    }

    #tcomments blockquote p {
        text-indent: 0.2rem;
    }

    #tcomments a {
        padding: 0 2px;
        color: #4cbf30;
        font-weight: 500;
        text-decoration: none;
    }

    #tcomments img {
        max-width: 100%;
        height: auto;
        cursor: pointer;
    }

    #tcomments ol li {
        list-style-type: decimal;
    }

    #tcomments ol,
    ul {
        display: block;
        padding-left: 2em;
        word-spacing: 0.05rem;
    }

    #tcomments ul li,
    ol li {
        display: list-item;
        line-height: 1.8rem;
        font-size: 1rem;
    }

    #tcomments ul li {
        list-style-type: disc;
    }

    #tcomments ul ul li {
        list-style-type: circle;
    }

    #tcomments table,
    th,
    td {
        padding: 12px 13px;
        border: 1px solid #dfe2e5;
    }

    #tcomments table,
    th,
    td {
        border: 0;
    }

    table tr:nth-child(2n),
    thead {
        background-color: #fafafa;
    }

    #tcomments table th {
        background-color: #f2f2f2;
        min-width: 80px;
    }

    #tcomments table td {
        min-width: 80px;
    }

    #tcomments h1 {
        font-size: 1.85rem;
        font-weight: bold;
        line-height: 2.2rem;
    }

    #tcomments h2 {
        font-size: 1.65rem;
        font-weight: bold;
        line-height: 1.9rem;
    }

    #tcomments h3 {
        font-size: 1.45rem;
        font-weight: bold;
        line-height: 1.7rem;
    }

    #tcomments h4 {
        font-size: 1.25rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    #tcomments h5 {
        font-size: 1.1rem;
        font-weight: bold;
        line-height: 1.4rem;
    }

    #tcomments h6 {
        font-size: 1rem;
        line-height: 1.3rem;
    }

    #tcomments p {
        font-size: 1rem;
        line-height: 1.5rem;
    }

    #tcomments hr {
        margin: 12px 0;
        border: 0;
        border-top: 1px solid #ccc;
    }

    #tcomments blockquote {
        margin: 15px 0;
        border-left: 5px solid #42b983;
        padding: 1rem 0.8rem 0.3rem 0.8rem;
        color: #666;
        background-color: rgba(66, 185, 131, .1);
    }

    #tcomments pre {
        font-family: monospace, monospace;
        padding: 1.2em;
        margin: .5em 0;
        background: #272822;
        overflow: auto;
        border-radius: 0.3em;
        tab-size: 4;
    }

    #tcomments code {
        font-family: monospace, monospace;
        padding: 1px 3px;
        font-size: 0.92rem;
        color: #e96900;
        background-color: #f8f8f8;
        border-radius: 2px;
    }

    #tcomments pre code {
        font-family: monospace, monospace;
        padding: 0;
        color: #e8eaf6;
        background-color: #272822;
    }

    #tcomments pre[class*="language-"] {
        padding: 1.2em;
        margin: .5em 0;
    }

    #tcomments code[class*="language-"],
    pre[class*="language-"] {
        color: #e8eaf6;
    }

    #tcomments [type="checkbox"]:not(:checked),
    [type="checkbox"]:checked {
        position: inherit;
        margin-left: -1.3rem;
        margin-right: 0.4rem;
        margin-top: -1px;
        vertical-align: middle;
        left: unset;
        visibility: visible;
    }

    #tcomments b,
    strong {
        font-weight: bold;
    }

    #tcomments dfn {
        font-style: italic;
    }

    #tcomments small {
        font-size: 85%;
    }

    #tcomments cite {
        font-style: normal;
    }

    #tcomments mark {
        background-color: #fcf8e3;
        padding: .2em;
    }

    #tcomments table,
    th,
    td {
        padding: 12px 13px;
        border: 1px solid #dfe2e5;
    }

    table tr:nth-child(2n),
    thead {
        background-color: #fafafa;
    }

    #tcomments table th {
        background-color: #f2f2f2;
        min-width: 80px;
    }

    #tcomments table td {
        min-width: 80px;
    }

    #tcomments [type="checkbox"]:not(:checked),
    [type="checkbox"]:checked {
        position: inherit;
        margin-left: -1.3rem;
        margin-right: 0.4rem;
        margin-top: -1px;
        vertical-align: middle;
        left: unset;
        visibility: visible;
    }
</style>

<div class="card twikoo-card" data-aos="fade-up">
    <div class="comment_headling" style="font-size: 20px; font-weight: 700; position: relative; padding-left: 20px; top: 15px; padding-bottom: 5px;">
        <i class="fas fa-comments fa-fw" aria-hidden="true"></i>
        <span>评论</span>
    </div>
    <div class="card-content" style="display: grid">
        <div id="tcomments"></div>
    </div>
</div>

<script src="/libs/twikoo/twikoo.all.min.js"></script>
<script>
    twikoo.init({
        envId: 'acw-cwu-9g3z3hoqc8232875',
        el: '#tcomments',
        region: '',
        path: ''
    }).then(function () {
        var tkInputs = document.querySelector('#twikoo').getElementsByTagName('input');
        for (var tkInputsIndex = 0; tkInputsIndex < tkInputs.length; tkInputsIndex++) {
            if (tkInputs[tkInputsIndex]) {
                tkInputs[tkInputsIndex].classList.add('browser-default');
            }
        }
    });
</script>

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="far fa-dot-circle"></i>&nbsp;本篇
            </div>
            <div class="card">
                <a href="/2021/03/04/Day3-pandas-%E2%85%A1/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/21.jpg" class="responsive-img" alt="Day3-pandas-Ⅱ">
                        
                        <span class="card-title">Day3-pandas-Ⅱ</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2021-03-04
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/%E6%95%B0%E6%8D%AE%E7%A7%91%E5%AD%A6/" class="post-category">
                                    数据科学
                                </a>
                            
                            
                        </span>
                    </div>
                </div>

                
                <div class="card-action article-tags">
                    
                    <a href="/tags/Pandas/">
                        <span class="chip bg-color">Pandas</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                下一篇&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2021/03/04/20210304/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/13.jpg" class="responsive-img" alt="下定决心Work Hard_Play music+alcohol hard">
                        
                        <span class="card-title">下定决心Work Hard_Play music+alcohol hard</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2021-03-04
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-user fa-fw"></i>
                            CY
                            
                        </span>
                    </div>
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>



<!-- 代码块功能依赖 -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>

<!-- 代码语言 -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>


<!-- 代码块复制 -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- 代码块收缩 -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>


    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget card" style="background-color: white;">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;目录</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('0'),
            headingSelector: 'h2, h3, h4'
        });

        // modify the toc link href to support Chinese.
        let i = 0;
        let tocHeading = 'toc-heading-';
        $('#toc-content a').each(function () {
            $(this).attr('href', '#' + tocHeading + (++i));
        });

        // modify the heading title id to support Chinese.
        i = 0;
        $('#articleContent').children('h2, h3, h4').each(function () {
            $(this).attr('id', tocHeading + (++i));
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>




    <footer class="page-footer bg-color">
    
    <div class="container row center-align" style="margin-bottom: 0px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            
                <span id="year">2019-2021</span>
            
            <span id="year">2019</span>
            <a href="/about" target="_blank">Cya Wu</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
            <br>
            
            
            
            
            
            
            <span id="busuanzi_container_site_pv">
                |&nbsp;<i class="far fa-eye"></i>&nbsp;总访问量:&nbsp;<span id="busuanzi_value_site_pv"
                    class="white-color"></span>&nbsp;次
            </span>
            
            
            <span id="busuanzi_container_site_uv">
                |&nbsp;<i class="fas fa-users"></i>&nbsp;总访问人数:&nbsp;<span id="busuanzi_value_site_uv"
                    class="white-color"></span>&nbsp;人
            </span>
            
            <br>
            
            <br>
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">
    <a href="https://github.com/CyaWu" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>



    <a href="mailto:这个先不公开@qq.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>







    <a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=不公开" class="tooltipped" target="_blank" data-tooltip="QQ联系我: 不公开" data-position="top" data-delay="50">
        <i class="fab fa-qq"></i>
    </a>







    <a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS 订阅" data-position="top" data-delay="50">
        <i class="fas fa-rss"></i>
    </a>

</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script type="text/javascript">
$(function () {
    var searchFunc = function (path, search_id, content_id) {
        'use strict';
        $.ajax({
            url: path,
            dataType: "xml",
            success: function (xmlResponse) {
                // get the contents from search data
                var datas = $("entry", xmlResponse).map(function () {
                    return {
                        title: $("title", this).text(),
                        content: $("content", this).text(),
                        url: $("url", this).text()
                    };
                }).get();
                var $input = document.getElementById(search_id);
                var $resultContent = document.getElementById(content_id);
                $input.addEventListener('input', function () {
                    var str = '<ul class=\"search-result-list\">';
                    var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                    $resultContent.innerHTML = "";
                    if (this.value.trim().length <= 0) {
                        return;
                    }
                    // perform local searching
                    datas.forEach(function (data) {
                        var isMatch = true;
                        var data_title = data.title.trim().toLowerCase();
                        var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                        var data_url = data.url;
                        data_url = data_url.indexOf('/') === 0 ? data.url : '/' + data_url;
                        var index_title = -1;
                        var index_content = -1;
                        var first_occur = -1;
                        // only match artiles with not empty titles and contents
                        if (data_title !== '' && data_content !== '') {
                            keywords.forEach(function (keyword, i) {
                                index_title = data_title.indexOf(keyword);
                                index_content = data_content.indexOf(keyword);
                                if (index_title < 0 && index_content < 0) {
                                    isMatch = false;
                                } else {
                                    if (index_content < 0) {
                                        index_content = 0;
                                    }
                                    if (i === 0) {
                                        first_occur = index_content;
                                    }
                                }
                            });
                        }
                        // show search results
                        if (isMatch) {
                            str += "<li><a href='" + data_url + "' class='search-result-title'>" + data_title + "</a>";
                            var content = data.content.trim().replace(/<[^>]+>/g, "");
                            if (first_occur >= 0) {
                                // cut out 100 characters
                                var start = first_occur - 20;
                                var end = first_occur + 80;
                                if (start < 0) {
                                    start = 0;
                                }
                                if (start === 0) {
                                    end = 100;
                                }
                                if (end > content.length) {
                                    end = content.length;
                                }
                                var match_content = content.substr(start, end);
                                // highlight all keywords
                                keywords.forEach(function (keyword) {
                                    var regS = new RegExp(keyword, "gi");
                                    match_content = match_content.replace(regS, "<em class=\"search-keyword\">" + keyword + "</em>");
                                });

                                str += "<p class=\"search-result\">" + match_content + "...</p>"
                            }
                            str += "</li>";
                        }
                    });
                    str += "</ul>";
                    $resultContent.innerHTML = str;
                });
            }
        });
    };

    searchFunc('/search.xml', 'searchInput', 'searchResult');
});
</script>

    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    <script src="/libs/others/clicklove.js" async="async"></script>
    
    
    <script async src="/libs/others/busuanzi.pure.mini.js"></script>
    

    

    

    <!--腾讯兔小巢-->
    
    

    

    

    
    <script src="/libs/instantpage/instantpage.js" type="module"></script>
    

</body>

</html>
